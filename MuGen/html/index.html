<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>MuGen: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MuGenLogo.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MuGen
   &#160;<span id="projectnumber">0.9.1</span>
   </div>
   <div id="projectbrief">Multi-trait hierarchical quantitative genetic models</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MuGen Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>MuGen is a C++ library that implements a comprehensive approach to Bayesian inference of multi-trait models for quantitative genetics. It enables genome-wide association studies and genome-enabled prediction, allows for complicated and unbalanced experimental designs, outlier observations, and missing data. However, while motivation for the construction of this library was to model genetic data, other types of data that could benefit from hierarchical treatment (see <a class="el" href="citelist.html#CITEREF_gelman04">[3]</a> <a class="el" href="citelist.html#CITEREF_gelman07">[2]</a> ) can also be analyzed.</p>
<p>The basic idea in hierarchical modeling is that so-called location parameters (i.e., group means and regression coefficients) can be arranged so that levels are nested within each other. This arrangement is particularly suited for Bayesian inference because model hierarchy fits a hierarchy of prior distributions <a class="el" href="citelist.html#CITEREF_gelman04">[3]</a> <a class="el" href="citelist.html#CITEREF_gelman07">[2]</a> <a class="el" href="citelist.html#CITEREF_greenberg10">[5]</a> . In addition to the location parameters, scale parameters (in our case, covariance matrices) are also modeled. Furthermore, some location parameters may not be hierarchically nested within other location parameters. Most parameters of interest can be fit into one of these categories, and given an implementation that can form a part of a model. These individual parameters are represented by objects of various classes in MuGen. Having provided implementations for Gibbs sampling of a variety of types of parameters, we enable the user to quickly build a flexible model that accomodates most applications without having to worry about computational complexity.</p>
<p>The structure of the hierarchy is represented by index classes (<a class="el" href="classRanIndex.html" title="Generic index class. ">RanIndex</a> and its derivatives) that store information about which location parameter is related to which upper or lower member of the model hierarchy. These index parameters can themselves stochastically change to accomodate mixture models where membership of a group is uncertain. However, the latter feature is still experimental.</p>
<p>Describing statistical hierarchical models unfortunately creates a collision of terms, since our classes are also arranged in a hierarchy. The latter is the C++ class derivation hierarchy and is not related to the statistical term. In the documentation we use the term "hierarchy" we to describe the statistical model relationships among variables unless otherwise specified.</p>
<p>Internal implementation of MuGen is multithreaded (using OpenMP, <a href="http://openmp.org/wp/">http://openmp.org/wp/</a>) and uses GNU Scientific Library and BLAS for computation. These computational details are hidden behind the interface which is designed for users familiar with basic C++ programming. A publication describing and validating the library is in preparation.</p>
<h2>File formats </h2>
<p>Unless explicitly specified otherwise, all files are saved and read as binary files created by GSL functions of the class <code>gsl_matrix_fwrite</code>. To read and write these files from R, we created a set of functions found in the file <a class="el" href="GSLRIO_8cpp.html" title="R interface for GSL binary file format. ">GSLRIO.cpp</a>. To compile for R, use </p><pre class="fragment">R CMD SHLIB GSLRIO.cpp -lgsl -O3 -DHAVE_INLINE -DGSL_RANGE_CHECK_OFF
</pre><p>and put the resulting GSLRIO.o where R can find it. It can then be loaded using <code>dyn.load()</code>.</p>
<h2>Dependencies </h2>
<p>Aside from the C++ standard library, the implementation depends only on the GNU Scienetific Library (GSL) (<a href="http://www.gnu.org/software/gsl/">http://www.gnu.org/software/gsl/</a>) and Basic Linear Algebra Subprograms (BLAS, <a href="http://www.netlib.org/blas/">http://www.netlib.org/blas/</a>). We are currently working with GSL version 1.16, but any version that supports linear algebra routines like Cholesky decomposition will work. Choosing the right BLAS implementation is crucial for performance. Generic BLAS is not recommended. We have successfully compiled MuGen with Apple's Accelerate framework, Intel's MKL (<a href="https://software.intel.com/en-us/intel-mkl">https://software.intel.com/en-us/intel-mkl</a>) and AMD's ACML (<a href="http://developer.amd.com/tools-and-sdks/cpu-development/amd-core-math-library-acml/">http://developer.amd.com/tools-and-sdks/cpu-development/amd-core-math-library-acml/</a>), all with good results. MKL seems to perform similarly to ACML on AMD Opteron processors we use to perform most computationally intensive tasks.</p>
<h2>Compilation instructions </h2>
<p>We use the GNU compiler collection (both version 4.7 and 4.9) for compilation. We did not use any C++11 features, so older compilers should work, too. We also successfully compiled the library with Intel icc and Apple's LLVM version 6.0. However, the latter does not support OpenMP, so the resulting code is not multithreaded.</p>
<p>To compile, make sure GSL is where the compiler can see it and is pointing to your preferred implemetation of BLAS. Then, simply run </p><pre class="fragment">g++ -c MuGen.cpp -lz -lgslcblas -lgsl -lpthread -lm -fopenmp \\
    -DHAVE_INLINE -DGSL_RANGE_CHECK_OFF -O3 -march=native

ar crv libMuGen.a MuGen.o
</pre><p>and move libMuGen.a to, say, /usr/local/lib/ and <a class="el" href="MuGen_8h.html" title="C++ classes for hierarchical Bayesian Multi-trait quantitative-genetic models. ">MuGen.h</a> to, say, /usr/local/include/.</p>
<p>MuGen has been successfully compiled under RedHat, Amazon Linux and Mac OS X Mavericks and Yosemite. On Mac OS X, at least when using gcc-4.7 and above, using -march=native does not always work. In that case, try including -m64 -msse4.2 -mfancy-math-387. Windows compilation has not been attempted. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 13 2015 17:34:25 for MuGen by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
